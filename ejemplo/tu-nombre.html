<!doctype html>
<html lang="es">
<head>
  <link rel="icon" href="../Logo VariaTap.png" type="image/png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tu Nombre</title>
  <meta name="description" content="Links y contacto" />
  <style>
    :root{
      /* Valores por defecto (se reemplazan al aplicar un theme) */
      --bg-solid:#1b1530; --bg-grad1:#2a1f54; --bg-grad2:#221b43; --bg-grad3:#170f2c;
      --card:#251b44; --text:#efeaff; --muted:#b9b1e3;
      --primary:#b693ff; --primary-rgb:182,147,255;
      --ring:0 0 0 3px rgba(182,147,255,.28); --radius:22px;
      --link-bg:#231a3f; --border:rgba(239,234,255,.12);
      --button1:#c6a8ff; --button2:#a98cff; --button-text:#130d26;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 1200px at 10% 0%, var(--bg-grad1) 0%, transparent 55%),
        radial-gradient(800px 800px at 90% 10%, var(--bg-grad2) 0%, transparent 60%),
        linear-gradient(180deg, var(--bg-grad3) 0%, var(--bg-solid) 100%);
      background-attachment:fixed; display:flex; align-items:stretch; justify-content:center; padding:20px;
    }
    .wrap{ width:min(560px,100%); display:flex; flex-direction:column; min-height:100svh; gap:22px; }
    header{ display:flex; flex-direction:column; align-items:center; gap:10px; padding-top:14px; text-align:center; }
    .avatar{ width:136px; height:136px; border-radius:50%; border:6px solid rgba(255,255,255,.08);
      box-shadow:0 10px 30px rgba(0,0,0,.45), inset 0 0 0 2px rgba(255,255,255,.06);
      object-fit:cover; background:#222;
    }
    h1{ font-size:1.5rem; margin:8px 0 0 0; font-weight:700; letter-spacing:.2px; }
    .subtitle{ margin:0; font-size:.98rem; color:var(--muted); line-height:1.4; }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border); border-radius:var(--radius); padding:18px;
      box-shadow:0 8px 30px rgba(0,0,0,.35); backdrop-filter:blur(6px);
    }
    .company-logo { max-width: 160px; max-height: 80px; margin-top: 8px; object-fit: contain; opacity: .9; }
    .links{ display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:12px; }
    .link{ display:flex; align-items:center; gap:10px; padding:14px 16px; text-decoration:none; color:var(--text);
      background: var(--link-bg); border:1px solid var(--border); border-radius:16px;
      transition:transform .15s ease, border-color .15s ease, background .15s ease, box-shadow .15s ease;
    }
    .link:hover{ transform:translateY(-2px); border-color:var(--primary); box-shadow:0 6px 18px rgba(var(--primary-rgb), .18); }
    .link:focus-visible{ outline:none; box-shadow:var(--ring); border-color:var(--primary); }
    .link span{ font-weight:600; letter-spacing:.2px; }
    .icon{ width:22px; height:22px; flex:0 0 auto; display:inline-block; }
    .footer-space{ flex:1 1 auto; }
    .download{ position:sticky; bottom:12px; display:none; text-align:center; padding:16px 18px; border-radius:18px;
      background: linear-gradient(180deg, var(--button1), var(--button2)); color: var(--button-text); text-decoration:none; font-weight:800; letter-spacing:.4px;
      border:1px solid var(--border); box-shadow:0 10px 30px rgba(var(--primary-rgb),.45);
      transition:transform .15s ease, filter .15s ease, box-shadow .15s ease;
    }
    .download:hover{ transform:translateY(-2px); filter:brightness(1.05); box-shadow:0 14px 36px rgba(var(--primary-rgb), .45); }
    .download:focus-visible{ outline:none; box-shadow:var(--ring),0 10px 30px rgba(var(--primary-rgb), .45); }
    .note{ display:none; text-align:center; color:var(--muted); font-size:.8rem; margin-top:6px; }
    .spacer{ height:6px; }
    .corner-logo{ position:fixed; top:6px; left:10px; width:36px; height:36px; z-index:999; opacity:.75; transition:opacity .15s ease;}
    .corner-logo img{ max-width:30px; opacity:75; transition:filter .2s ease; filter:drop-shadow(0 0 3px white); drop-shadow(0 0 6px white); }
    .corner-logo:hover{ opacity:1; }

    /* ====== UI Temas ====== */
    .themes-card h3{ margin:0 0 12px 0; font-size:1rem; color:var(--muted); }
    .theme-controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:12px; }
    .select{ appearance:none; background:var(--link-bg); color:var(--text); border:1px solid var(--border);
      border-radius:12px; padding:10px 12px; font-weight:600; cursor:pointer; }
    .btn{ background:var(--link-bg); color:var(--text); border:1px solid var(--border);
      border-radius:12px; padding:10px 12px; font-weight:700; cursor:pointer;
      transition:transform .15s ease, border-color .15s ease; }
    .btn:hover{ transform:translateY(-1px); border-color:var(--primary); }

    .theme-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:10px; }
    .theme-chip{
      position:relative; height:70px; border-radius:14px; border:1px solid var(--border);
      overflow:hidden; cursor:pointer; display:flex; align-items:flex-end; padding:8px; font-weight:700;
      color:#fff; text-shadow:0 2px 6px rgba(0,0,0,.45);
      transition: transform .15s ease, border-color .15s ease;
    }
    .theme-chip:hover{ transform:translateY(-2px); border-color:var(--primary); }
    .theme-chip.active{ border-color:var(--primary); box-shadow:0 0 0 2px rgba(var(--primary-rgb), .3) inset; }
    .chip-name{ font-size:.86rem; }
  </style>
</head>
<body>
  <main class="wrap" role="main">
    <header aria-label="Perfil">
      <img id="avatar" class="avatar" src="avatar.jpg" alt="Foto de perfil" />
      <h1 id="name">Tu Nombre</h1>
      <p id="subtitle" class="subtitle">Tu descripción corta o subtítulo.</p>
      <img id="companyLogo" class="company-logo" src="" alt="Logo de la empresa" style="display:none;" />
    </header>

    <section class="card" aria-label="Enlaces">
      <div id="links" class="links"></div>
    </section>

    <!-- ===== Tarjeta de Temas ===== -->
    <section class="card themes-card" aria-label="Temas de la página">
      <h3>Temas</h3>
      <div class="theme-controls">
        <select id="themeSelect" class="select" aria-label="Seleccionar tema"></select>
        <button id="copyLink" class="btn" type="button" aria-label="Copiar enlace con tema">Copiar enlace con tema</button>
      </div>
      <div id="themeGrid" class="theme-grid" role="list"></div>
    </section>

    <div class="footer-space"></div>

    <a id="contactBtn" class="download" href="#" download aria-label="Descargar contacto">Add to Contacts</a>
    <div id="contactNote" class="note">Tap ‘Add to Contacts’ to save it.</div>
    <div class="spacer"></div>
    <a href="https://variatap.com" target="_blank" rel="noopener noreferrer" class="corner-logo">
      <img src="../Logo VariaTap.png" alt="Logo VariaTap" />
    </a>
  </main>

  <!-- === CONFIG (se rellena desde JSON) ================================ -->
  <script id="config" type="application/json">
{
  "name": "Tu Nombre",
  "title": "Tu Nombre",
  "subtitle": "Tu descripción",
  "avatar": "avatar.jpg",
  "companyLogo": "empresa.png",
  "email": "tucorreo@tumail.com",
  "phones": {
    "cell": "+520000000000",
    "work": "+521111111111",
    "home": ""
  },
  "socials": {
    "instagram": "https://www.instagram.com",
    "x": "https://www.x.com",
    "tiktok": "https://www.tiktok.com",
    "youtube": "https://www.youtube.com",
    "linkedin": "https://www.linkedin.com",
    "facebook": "https://www.facebook.com",
    "website": "https://variatap.com",
    "whatsapp": "https://wa.me"
  },
  "contactVcf": "contacto.vcf",
  "outputFolderName": "Ejemplo",
  "theme": "lavender"
}
  </script>
  <!-- ================================================================== -->

  <script>
    /* ====== THEMES (tal como me pasaste) ====== */
    const THEMES = {
      "default (dark glow)": {"--bg-solid":"#0f1115","--bg-grad1":"#1b2640","--bg-grad2":"#1a2e2f","--bg-grad3":"#0b0e13","--card":"#141823","--text":"#e8ecf1","--muted":"#9aa4b2","--primary":"#62d0ff","--primary-rgb":"98,208,255","--ring":"0 0 0 3px rgba(98,208,255,.25)","--radius":"22px","--link-bg":"#101521","--border":"rgba(255,255,255,.06)","--button1":"#28c0ff","--button2":"#10a3df","--button-text":"#001018"},
      "ocean":{"--bg-solid":"#0b1220","--bg-grad1":"#112548","--bg-grad2":"#0e2a33","--bg-grad3":"#0a1422","--card":"#0f1a2b","--text":"#e6f3ff","--muted":"#9bb3cc","--primary":"#3ac1ff","--primary-rgb":"58,193,255","--ring":"0 0 0 3px rgba(58,193,255,.25)","--radius":"20px","--link-bg":"#0e1a2a","--border":"rgba(225,240,255,.08)","--button1":"#34b5ff","--button2":"#1f8edb","--button-text":"#03101a"},
      "sunset":{"--bg-solid":"#1a0f14","--bg-grad1":"#3a1622","--bg-grad2":"#2b141a","--bg-grad3":"#150a0e","--card":"#2a141a","--text":"#ffece6","--muted":"#f2b5a5","--primary":"#ff7a59","--primary-rgb":"255,122,89","--ring":"0 0 0 3px rgba(255,122,89,.25)","--radius":"22px","--link-bg":"#2b1316","--border":"rgba(255,236,230,.10)","--button1":"#ff9966","--button2":"#ff7a59","--button-text":"#230b07"},
      "forest":{"--bg-solid":"#0d1411","--bg-grad1":"#143227","--bg-grad2":"#10261e","--bg-grad3":"#0a120f","--card":"#122019","--text":"#e9f5ef","--muted":"#a2c3b4","--primary":"#51d19a","--primary-rgb":"81,209,154","--ring":"0 0 0 3px rgba(81,209,154,.25)","--radius":"20px","--link-bg":"#0f1f18","--border":"rgba(233,245,239,.08)","--button1":"#58dfa6","--button2":"#2dbf8a","--button-text":"#02140e"},
      "mono":{"--bg-solid":"#0e0e0f","--bg-grad1":"#1a1a1c","--bg-grad2":"#141417","--bg-grad3":"#0d0d0f","--card":"#151517","--text":"#f1f1f1","--muted":"#a9a9b0","--primary":"#ffffff","--primary-rgb":"255,255,255","--ring":"0 0 0 3px rgba(255,255,255,.18)","--radius":"18px","--link-bg":"#151517","--border":"rgba(255,255,255,.10)","--button1":"#f1f1f1","--button2":"#cfcfd4","--button-text":"#0a0a0a"},
      "silver":{"--bg-solid":"#f0f1f3","--bg-grad1":"#ffffff","--bg-grad2":"#e7e9ee","--bg-grad3":"#f5f6f8","--card":"#ffffff","--text":"#202225","--muted":"#6c6f76","--primary":"#6b7a90","--primary-rgb":"107,122,144","--ring":"0 0 0 3px rgba(107,122,144,.22)","--radius":"20px","--link-bg":"#f4f6f9","--border":"rgba(0,0,0,.08)","--button1":"#e9edf2","--button2":"#d9dee6","--button-text":"#1a1c20"},
      "gold":{"--bg-solid":"#1a1308","--bg-grad1":"#3b2a10","--bg-grad2":"#2c1f0c","--bg-grad3":"#120c05","--card":"#2b1d0a","--text":"#fff8e6","--muted":"#e6d3a9","--primary":"#ffcc33","--primary-rgb":"255,204,51","--ring":"0 0 0 3px rgba(255,204,51,.25)","--radius":"22px","--link-bg":"#2c1f0c","--border":"rgba(255,204,51,.15)","--button1":"#ffd966","--button2":"#ffcc33","--button-text":"#201600"},
      "lavender":{"--bg-solid":"#1b1530","--bg-grad1":"#2a1f54","--bg-grad2":"#221b43","--bg-grad3":"#170f2c","--card":"#251b44","--text":"#efeaff","--muted":"#b9b1e3","--primary":"#b693ff","--primary-rgb":"182,147,255","--ring":"0 0 0 3px rgba(182,147,255,.28)","--radius":"22px","--link-bg":"#231a3f","--border":"rgba(239,234,255,.12)","--button1":"#c6a8ff","--button2":"#a98cff","--button-text":"#130d26"},
      "rose":{"--bg-solid":"#2a0f1b","--bg-grad1":"#4a1830","--bg-grad2":"#371427","--bg-grad3":"#1c0a14","--card":"#3a1525","--text":"#ffe7f0","--muted":"#f3b6c9","--primary":"#ff6b9a","--primary-rgb":"255,107,154","--ring":"0 0 0 3px rgba(255,107,154,.28)","--radius":"22px","--link-bg":"#321222","--border":"rgba(255,231,240,.12)","--button1":"#ff9fbc","--button2":"#ff6b9a","--button-text":"#280913"},
      "mint":{"--bg-solid":"#0b1f1b","--bg-grad1":"#124438","--bg-grad2":"#0e372f","--bg-grad3":"#09231e","--card":"#0f2f28","--text":"#e9fff8","--muted":"#a9e2d2","--primary":"#66e3c0","--primary-rgb":"102,227,192","--ring":"0 0 0 3px rgba(102,227,192,.26)","--radius":"20px","--link-bg":"#0e2b25","--border":"rgba(233,255,248,.10)","--button1":"#7cf0cd","--button2":"#44d5b0","--button-text":"#031a14"},
      "teal":{"--bg-solid":"#081e22","--bg-grad1":"#0e3940","--bg-grad2":"#0c2e35","--bg-grad3":"#061b1f","--card":"#0d2a30","--text":"#e7fbff","--muted":"#9fd0d8","--primary":"#31c6d4","--primary-rgb":"49,198,212","--ring":"0 0 0 3px rgba(49,198,212,.26)","--radius":"20px","--link-bg":"#0c252b","--border":"rgba(231,251,255,.10)","--button1":"#49d3df","--button2":"#23b7c6","--button-text":"#041316"},
      "indigo":{"--bg-solid":"#0e1026","--bg-grad1":"#1b1e4d","--bg-grad2":"#15183b","--bg-grad3":"#0b0d1e","--card":"#14183a","--text":"#e9ecff","--muted":"#aab0e8","--primary":"#6677ff","--primary-rgb":"102,119,255","--ring":"0 0 0 3px rgba(102,119,255,.25)","--radius":"22px","--link-bg":"#121636","--border":"rgba(233,236,255,.10)","--button1":"#7f8cff","--button2":"#5a6bff","--button-text":"#080a1a"},
      "coral":{"--bg-solid":"#1c1210","--bg-grad1":"#3a211b","--bg-grad2":"#2b1a16","--bg-grad3":"#120a08","--card":"#2c1a16","--text":"#fff0eb","--muted":"#f0b9ab","--primary":"#ff8a65","--primary-rgb":"255,138,101","--ring":"0 0 0 3px rgba(255,138,101,.25)","--radius":"20px","--link-bg":"#261713","--border":"rgba(255,240,235,.10)","--button1":"#ffad91","--button2":"#ff8a65","--button-text":"#2a120d"},
      "cyberpunk":{"--bg-solid":"#0b0014","--bg-grad1":"#30003f","--bg-grad2":"#001b33","--bg-grad3":"#070010","--card":"#1b0a29","--text":"#f4eaff","--muted":"#cfa9ff","--primary":"#ff2bd1","--primary-rgb":"255,43,209","--ring":"0 0 0 3px rgba(255,43,209,.28)","--radius":"22px","--link-bg":"#170824","--border":"rgba(244,234,255,.12)","--button1":"#ff73e4","--button2":"#ff2bd1","--button-text":"#19031e"}
    };

    const ICONS = {
      instagram:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7Zm5 3.5A5.5 5.5 0 1 1 6.5 13A5.5 5.5 0 0 1 12 7.5Zm0 2A3.5 3.5 0 1 0 15.5 13A3.5 3.5 0 0 0 12 9.5ZM18 6.2a1 1 0 1 1-1.999.002A1 1 0 0 1 18 6.2Z"/></svg>',
      x:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M13.47 10.87 20.79 3h-1.73l-6.34 6.87L7.59 3H2.2l7.76 11.12L2.2 21h1.73l6.73-7.3L16.41 21h5.39l-8.33-10.13ZM11.84 12.87l-.78-1.11L4.68 4.3h2.34l4.99 7.07.78 1.11 6.66 9.44h-2.34l-5.27-7.05Z"/></svg>',
      tiktok:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M21 8.5a7.5 7.5 0 0 1-5.2-2.15V16a6 6 0 1 1-6-6 6.1 6.1 0 0 1 1 .08V12a3.5 3.5 0 1 0 3.5 3.5V2h3.35A4.5 4.5 0 0 0 21 6.5Z"/></svg>',
      youtube:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M23 12s0-3.4-.44-5.03a3.13 3.13 0 0 0-2.2-2.2C18.73 4.33 12 4.33 12 4.33s-6.73 0-8.36.44a3.13 3.13 0 0 0-2.2 2.2C1 8.6 1 12 1 12s0 3.4.44 5.03a3.13 3.13 0 0 0 2.2 2.2c1.63.44 8.36.44 8.36.44s6.73 0  8.36-.44a3.13 3.13 0 0 0 2.2-2.2C23 15.4 23 12 23 12ZM9.75 15.5v-7l6 3.5Z"/></svg>',
      linkedin:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M4.98 3.5a2.5 2.5 0 1 1 0 5.001 2.5 2.5 0 0 1 0-5ZM3 9h4v12H3zm7 0h3.8v1.64h.05c.53-.95 1.84-1.95 3.79-1.95 4.05 0 4.8 2.46 4.8 5.66V21h-4v-5.3c0-1.27-.02-2.9-1.77-2.9-1.77 0-2.04 1.38-2.04 2.8V21h-4z"/></svg>',
      facebook:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M14 4h-2.2C9.7 4 8 5.7 8 7.8V10H6v3h2v7h3v-7h2.2l.8-3H11V7.8c0-.44.36-.8.8-.8H14V4z"/></svg>',
      website:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2Zm0 2c1.1 0 2.13.3 3.02.82A14.8 14.8 0 0 0 12 9a14.8 14.8 0 0 0-3.02-6.18A7.96 7.96 0 0 1 12 4ZM8.6 5.14A12.8 12.8 0 0 1 11 9H5.18a8.02 8.02 0 0 1 3.42-3.86ZM4.07 11H11v2H4.07a8.02 8.02 0 0 1 0-2ZM5.18 15H11a12.8 12.8 0 0 1-2.4 3.86A8.02 8.02 0 0 1 5.18 15Zm6.82 0h6.75a8.02 8.02 0 0 1-3.42 3.86A12.8 12.8 0 0 1 12 15Zm0-4a12.8 12.8 0 0 1 2.4-3.86A8.02 8.02 0 0 1 18.82 11H12Zm7.93 0c.09.66.09 1.34 0 2H13v-2h6.93Z"/></svg>',
      whatsapp:'<svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M16.7 14.3c-.3-.2-1.8-.9-2.1-1s-.5-.2-.7.2-.8 1-1 1.2c-.2.2-.4.2-.7.1-.3-.2-1.2-.5-2.3-1.4-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6.1-.1.3-.4.5-.6.2-.2.3-.4.4-.6.1-.2 0-.5 0-.6s-.7-1.7-1-2.3c-.3-.6-.5-.5-.7-.5h-.6c-.2 0-.6.1-.9.4-.3.3-1.2 1.1-1.2 2.6s1.2 3 1.3 3.2c.2.3 2.3 3.5 5.6 4.8.8.3 1.4.5 1.9.6.8.3 1.5.2 2 .1.6-.1 1.8-.7 2.1-1.3.3-.6.3-1.2.2-1.3 0-.1-.3-.2-.6-.4zM12 2a10 10 0 0 0-8.9 14.6L2 22l5.6-1.5A10 10 0 1 0 12 2z"/></svg>'
    };
    const ORDER = ["instagram","x","tiktok","youtube","linkedin","facebook","website","whatsapp"];

    function normalizeSocials(raw){
      raw = raw || {};
      return {
        instagram: raw.instagram || "",
        x: raw.x || raw.twitter || "",
        tiktok: raw.tiktok || "",
        youtube: raw.youtube || "",
        linkedin: raw.linkedin || "",
        facebook: raw.facebook || raw.facebool || raw.fb || "",
        website: raw.website || raw.web || raw.portfolio || "",
        whatsapp: raw.whatsapp || ""
      };
    }
    function createLink(network, url, label) {
      const a = document.createElement("a");
      a.className = "link";
      a.href = url; a.target = "_blank"; a.rel="noopener noreferrer";
      a.setAttribute("aria-label", label);
      a.innerHTML = `${ICONS[network] ?? ""}<span>${label}</span>`;
      return a;
    }

    // ====== THEMING ======
    const $root = document.documentElement;
    const STORAGE_KEY = "vt_theme";

    function applyTheme(name){
      const theme = THEMES[name];
      if(!theme) return;
      for(const [k,v] of Object.entries(theme)){
        $root.style.setProperty(k, v);
      }
      localStorage.setItem(STORAGE_KEY, name);
      // activar chip
      document.querySelectorAll(".theme-chip").forEach(c=>c.classList.toggle("active", c.dataset.theme === name));
      const sel = document.getElementById("themeSelect");
      if(sel && sel.value !== name) sel.value = name;
      // actualizar ?theme=
      const url = new URL(location.href);
      url.searchParams.set("theme", name);
      history.replaceState(null, "", url);
    }

    function paramTheme(){
      const url = new URL(location.href);
      return url.searchParams.get("theme");
    }

    function populateThemesUI(current){
      // selector
      const sel = document.getElementById("themeSelect");
      sel.innerHTML = "";
      Object.keys(THEMES).forEach(name=>{
        const opt = document.createElement("option");
        opt.value = name; opt.textContent = name;
        if(name === current) opt.selected = true;
        sel.appendChild(opt);
      });
      sel.addEventListener("change", e => applyTheme(e.target.value));

      // chips visuales
      const grid = document.getElementById("themeGrid");
      grid.innerHTML = "";
      Object.entries(THEMES).forEach(([name, vars])=>{
        const chip = document.createElement("div");
        chip.className = "theme-chip";
        chip.dataset.theme = name;
        chip.style.background = `
          radial-gradient(240px 120px at 10% 0%, ${vars["--bg-grad1"]} 0%, transparent 60%),
          radial-gradient(200px 120px at 90% 10%, ${vars["--bg-grad2"]} 0%, transparent 60%),
          linear-gradient(180deg, ${vars["--bg-grad3"]} 0%, ${vars["--bg-solid"]} 100%)
        `;
        const label = document.createElement("div");
        label.className = "chip-name";
        label.textContent = name;
        chip.appendChild(label);
        chip.addEventListener("click", ()=>applyTheme(name));
        grid.appendChild(chip);
      });
      // marcar activo
      document.querySelectorAll(".theme-chip").forEach(c=>c.classList.toggle("active", c.dataset.theme === current));
    }

    (async () => {
      // Cargar config
      let cfg = {};
      try {
        cfg = JSON.parse(document.getElementById("config").textContent);
      } catch (e) { console.error("Config inline inválida:", e); }

      // Perfil básico
      document.getElementById("name").textContent = (cfg.name || "Tu Nombre").replace(/^@+/, "");
      document.getElementById("subtitle").textContent = cfg.subtitle || "";
      const avatar = document.getElementById("avatar");
      avatar.src = cfg.avatar || "avatar.jpg";
      avatar.alt = `Foto de perfil de ${cfg.name || "usuario"}`;

      const logo = document.getElementById("companyLogo");
      if (cfg.companyLogo && cfg.companyLogo.trim() !== "") {
        logo.src = cfg.companyLogo;
        logo.style.display = "block";
      } else {
        logo.style.display = "none";
      }

      // Enlaces
      const linksEl = document.getElementById("links");
      linksEl.innerHTML = "";
      const socials = normalizeSocials(cfg.socials);
      const labels = Object.assign({
        instagram:"Instagram", x:"X / Twitter", tiktok:"TikTok", youtube:"YouTube",
        linkedin:"LinkedIn", facebook:"Facebook", website:"Web / Portfolio", whatsapp:"WhatsApp"
      }, cfg.labels || {});
      ORDER.forEach(net => {
        const url = (socials[net] || "").trim();
        if (url) linksEl.appendChild(createLink(net, url, labels[net] || net));
      });

      // Contacto .vcf
      const btn = document.getElementById("contactBtn");
      const note = document.getElementById("contactNote");
      const vcf = (cfg.contactVcf || "").trim();
      if (vcf) {
        btn.href = vcf;
        btn.download = vcf.split("/").pop() || "contacto.vcf";
        btn.style.display = "block";
        note.style.display = "block";
      }

      // Tema inicial: prioridad => ?theme > localStorage > cfg.theme > "lavender"
      const initial = paramTheme() || localStorage.getItem(STORAGE_KEY) || cfg.theme || "lavender";
      populateThemesUI(initial);
      applyTheme(initial);

      // Copiar enlace con tema
      document.getElementById("copyLink").addEventListener("click", async ()=>{
        try {
          await navigator.clipboard.writeText(location.href);
          const btn = document.getElementById("copyLink");
          const prev = btn.textContent;
          btn.textContent = "¡Copiado!";
          setTimeout(()=>btn.textContent = prev, 1400);
        } catch (e) {
          alert("No se pudo copiar. Copia manualmente: " + location.href);
        }
      });
    })();
  </script>
</body>
</html>
